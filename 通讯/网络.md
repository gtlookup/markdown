# TCP / UDP

都在`传输层`，都是在程序间传输数据。数据可以是文本文件、视频、图片等，都是一堆二进制数

区别在于：

- TCP：基于连接（全双工）。如打电话，先接通再通话。TCP的过程：
  - 三次握手：建立接连的过程
    - 一次：C端询问是否可以连接（发送`SYN`包）
    - 二次：S端如果同意连接，回复`SYN+ACK`包
    - 三次：C端接到同意`SYN+ACK`包后，再发送 `ACK` 包，连接建立
  - 传输确认
    - 发送端每次发送都带有序号，接收端接到的包可能是无序的，
    - 但有序号在就可以把包按序号拼成完整数据
    - 如果接收端发现丢包，则把丢包的序号发给发送端让其重发
  - 四次挥手：C/S两端都可以发起关闭连接
    - 一次：C端发起关闭一方发送 `FIN` 包，自己进入`终止等待1状态`
    - 二次：S端接到后回复 `ACK` 包，自己进入`关闭等待状态`，C端接到后进入`终止等待2状态`。S端此时还可以发送未发送的数据，C端还可以接收数据
    - 三次：待S端发完未发送数据后，再向C端发送个 `FIN` 包后进入最后 `确认状态`
    - 四次：C端收到 `FIN` 包后再发送 `ACK` 包后进入`超时等待状态`，经过超时时间后关闭连接，而S端收到 `ACK` 包后立即关闭连接
- UDP：基于非连接。如写信，信发出后，对方是否接到、内容是否完整、如果写多封顺序是否正确
  - 就是简单的将数据一次性发送

TCP 适用场景：因稳定性可靠，适用发送文件、邮件、浏览网页等

UDP适用场景：性能损耗少、资源占用少、稳定性弱，可能丢包，但速度快。适用域名查询、实时通话、视频直播、隧道网络（VPN、VXLAN）等